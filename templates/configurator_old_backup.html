<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeLink Widget Configurator - Generate Your Embed Code</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons - Multiple CDN fallbacks -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Fallback CDN -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.1/css/all.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 18px;
            opacity: 0.9;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .card h2 {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 8px;
        }

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group input[type="url"],
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s;
        }

        .form-group input[type="color"] {
            width: 100%;
            height: 50px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .color-preview {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 8px;
        }

        .color-box {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
        }

        .preview-area {
            background: #f7fafc;
            border-radius: 15px;
            padding: 40px;
            min-height: 400px;
            position: relative;
        }

        .preview-label {
            position: absolute;
            top: 15px;
            left: 20px;
            background: #667eea;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .code-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .code-block {
            background: #2d3748;
            color: #68d391;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.8;
            overflow-x: auto;
            position: relative;
            margin-top: 15px;
        }

        .copy-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .copy-btn.copied {
            background: #48bb78;
        }

        .generate-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .steps {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            margin-top: 30px;
        }

        .step {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            align-items: start;
        }

        .step-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .step-content h3 {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .step-content p {
            font-size: 14px;
            color: #718096;
            line-height: 1.6;
        }

        /* Fallback for Font Awesome if CDN fails */
        i.fas::before, i.fa::before {
            font-family: 'Font Awesome 6 Free', 'Font Awesome 6 Pro', sans-serif !important;
            font-weight: 900 !important;
            font-style: normal;
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-rocket"></i> üöÄ LifeLink Widget Configurator</h1>
            <p>Customize your disaster response chatbot and generate embed code for your website</p>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Configuration Panel -->
            <div class="card">
                <h2><i class="fas fa-sliders-h"></i> ‚öôÔ∏è Widget Configuration</h2>
                
                <div class="form-group" style="background: #e0f2fe; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 2px solid #0ea5e9;">
                    <label style="color: #0369a1; font-size: 13px; margin-bottom: 5px;"><i class="fas fa-info-circle"></i> <strong>Widget URL (Required)</strong></label>
                    <input type="url" id="widgetUrl" value="https://eng.skillfusion.tech/widget.js" placeholder="https://your-domain.com/widget.js">
                    <p style="font-size: 12px; color: #0369a1; margin-top: 8px; margin-bottom: 0;">
                        Enter the full URL where widget.js is hosted. The API will be auto-detected from this URL.
                    </p>
                    <p style="font-size: 11px; color: #16a34a; margin-top: 5px; margin-bottom: 0; font-weight: 600;">
                        üîí HTTPS enabled with trusted SSL certificate from Let's Encrypt!
                    </p>
                </div>

                <div class="form-group">
                    <label>Primary Color (Header, Buttons)</label>
                    <input type="color" id="primaryColor" value="#331013">
                    <div class="color-preview">
                        <div class="color-box" id="primaryColorPreview" style="background: #331013;"></div>
                        <span id="primaryColorHex">#331013</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Button Color (Floating Button)</label>
                    <input type="color" id="buttonColor" value="#9b224a">
                    <div class="color-preview">
                        <div class="color-box" id="buttonColorPreview" style="background: #9b224a;"></div>
                        <span id="buttonColorHex">#9b224a</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Button Position</label>
                    <select id="position">
                        <option value="bottom-right">Bottom Right</option>
                        <option value="bottom-left">Bottom Left</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Button Size (px)</label>
                    <input type="number" id="buttonSize" value="56" min="40" max="80">
                </div>

                <div class="form-group">
                    <label>Window Width (px)</label>
                    <input type="number" id="windowWidth" value="400" min="300" max="600">
                </div>

                <div class="form-group">
                    <label>Window Height (px)</label>
                    <input type="number" id="windowHeight" value="600" min="400" max="800">
                </div>

                <div class="form-group">
                    <label>Brand Name</label>
                    <input type="text" id="brandName" value="SkillFusion" placeholder="Your Company Name">
                </div>

                <button class="generate-btn" onclick="updatePreview()">
                    <i class="fas fa-sync-alt"></i> Update Preview & Generate Code
                </button>
            </div>

            <!-- Live Preview -->
            <div class="card">
                <h2><i class="fas fa-eye"></i> üëÅÔ∏è Live Preview</h2>
                <div class="preview-area" id="previewArea">
                    <div class="preview-label">Live Demo</div>
                    <!-- Widget will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Generated Code -->
        <div class="code-card">
            <h2><i class="fas fa-code"></i> üíª Your Embed Code</h2>
            <p style="color: #718096; margin-bottom: 15px;">Copy this code and paste it before the closing &lt;/body&gt; tag in your HTML:</p>
            
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode()">
                    <i class="fas fa-copy"></i> Copy Code
                </button>
                <pre id="embedCode">&lt;!-- LifeLink Disaster Response Chatbot --&gt;
&lt;script&gt;
  window.LifeLinkConfig = {
    primaryColor: '#331013',
    buttonColor: '#9b224a',
    position: 'bottom-right',
    buttonSize: 56,
    windowWidth: 400,
    windowHeight: 600,
    brandName: 'SkillFusion'
  };
&lt;/script&gt;
&lt;script src="https://eng.skillfusion.tech/widget.js"&gt;&lt;/script&gt;</pre>
            </div>
        </div>

        <!-- How to Use Steps -->
        <div class="steps">
            <h2 style="margin-bottom: 30px;"><i class="fas fa-cloud-upload-alt"></i> For Hosting (You - One Time Setup)</h2>
            
            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h3>üñ•Ô∏è Deploy to Your Ubuntu Droplet</h3>
                    <p>Upload LifeLink chatbot files to your Ubuntu server using SSH. See <code>DEPLOYMENT_GUIDE.md</code> for complete step-by-step instructions including Nginx, Gunicorn, and SSL setup.</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h3>üîí Setup SSL & Domain</h3>
                    <p>Point your domain (e.g., <code>chatbot.yourdomain.com</code>) to your Ubuntu droplet IP. Install free SSL certificate using Let's Encrypt for secure HTTPS access.</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <h3>‚úÖ Verify widget.js is Accessible</h3>
                    <p>Make sure <code>https://your-domain.com/widget.js</code> is publicly accessible. The Flask server automatically serves this file at the <code>/widget.js</code> endpoint with proper CORS headers.</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">4</div>
                <div class="step-content">
                    <h3>üåê Share Your Hosted Link</h3>
                    <p><strong>Once deployed, anyone can embed your chatbot by using your hosted link!</strong> Share <code>https://your-domain.com/widget.js</code> and this configurator page (<code>/configurator</code>) with others so they can customize and embed it on their websites.</p>
                </div>
            </div>
        </div>

        <!-- For Website Owners -->
        <div class="steps" style="border: 3px solid #667eea;">
            <h2 style="margin-bottom: 30px; color: #667eea;"><i class="fas fa-code"></i> For Website Owners (Using Hosted Widget)</h2>
            
            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h3>üé® Customize Your Widget</h3>
                    <p>Use the configuration panel above to customize colors, position, size, and branding to match YOUR website design.</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h3>üìã Copy the Generated Code</h3>
                    <p>Click "Copy Code" button above. The embed code includes your custom configuration and links to the hosted widget.js file.</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <h3>üìù Paste Before &lt;/body&gt; Tag</h3>
                    <p>Open your website's HTML file and paste the copied code just before the closing <code>&lt;/body&gt;</code> tag. Works on any HTML website, WordPress, Wix, Shopify, etc!</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">4</div>
                <div class="step-content">
                    <h3>‚úÖ Test & Go Live!</h3>
                    <p>Refresh your website to see the chatbot floating button appear. Click it to test - it connects to the hosted API automatically. No backend setup needed on your end! üéâ</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">5</div>
                <div class="step-content">
                    <h3>üîÑ Update Anytime</h3>
                    <p><strong>Want to change colors?</strong> Just update the <code>LifeLinkConfig</code> object in your embed code. No need to reinstall anything - changes apply instantly!</p>
                </div>
            </div>
        </div>

        <!-- Key Benefits Box -->
        <div class="steps" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin-top: 30px;">
            <h2 style="margin-bottom: 20px; color: white;"><i class="fas fa-star"></i> Why Use Hosted LifeLink?</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; backdrop-filter: blur(10px);">
                    <h3 style="color: white; margin-bottom: 10px;">üöÄ No Backend Required</h3>
                    <p style="color: rgba(255,255,255,0.9);">Website owners just paste code - no server setup, no database, no hosting costs!</p>
                </div>
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; backdrop-filter: blur(10px);">
                    <h3 style="color: white; margin-bottom: 10px;">üé® Fully Customizable</h3>
                    <p style="color: rgba(255,255,255,0.9);">Each website can customize colors, position, size, and branding to match their design.</p>
                </div>
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; backdrop-filter: blur(10px);">
                    <h3 style="color: white; margin-bottom: 10px;">üîÑ Always Updated</h3>
                    <p style="color: rgba(255,255,255,0.9);">When you improve the chatbot, all websites using it get updates automatically!</p>
                </div>
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; backdrop-filter: blur(10px);">
                    <h3 style="color: white; margin-bottom: 10px;">üÜì 100% Free</h3>
                    <p style="color: rgba(255,255,255,0.9);">Open source and free for everyone. You host once, thousands can use it!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Update color previews
        document.getElementById('primaryColor').addEventListener('input', (e) => {
            const color = e.target.value;
            document.getElementById('primaryColorPreview').style.background = color;
            document.getElementById('primaryColorHex').textContent = color;
        });

        document.getElementById('buttonColor').addEventListener('input', (e) => {
            const color = e.target.value;
            document.getElementById('buttonColorPreview').style.background = color;
            document.getElementById('buttonColorHex').textContent = color;
        });

        function updatePreview() {
            // Get configuration
            const widgetUrl = document.getElementById('widgetUrl').value;
            const config = {
                widgetUrl: widgetUrl,
                primaryColor: document.getElementById('primaryColor').value,
                buttonColor: document.getElementById('buttonColor').value,
                position: document.getElementById('position').value,
                buttonSize: parseInt(document.getElementById('buttonSize').value),
                windowWidth: parseInt(document.getElementById('windowWidth').value),
                windowHeight: parseInt(document.getElementById('windowHeight').value),
                brandName: document.getElementById('brandName').value
            };

            // Generate embed code (without apiUrl - it's automatic!)
            const embedCode = `&lt;!-- LifeLink Disaster Response Chatbot --&gt;
&lt;script&gt;
  window.LifeLinkConfig = {
    primaryColor: '${config.primaryColor}',
    buttonColor: '${config.buttonColor}',
    position: '${config.position}',
    buttonSize: ${config.buttonSize},
    windowWidth: ${config.windowWidth},
    windowHeight: ${config.windowHeight},
    brandName: '${config.brandName}'
  };
&lt;/script&gt;
&lt;script src="${config.widgetUrl}"&gt;&lt;/script&gt;`;

            document.getElementById('embedCode').innerHTML = embedCode;

            // Update preview (reload widget with new config)
            const previewArea = document.getElementById('previewArea');
            
            // Remove old widget if exists
            const oldWidget = document.getElementById('lifelink-chatbot-widget');
            if (oldWidget) {
                oldWidget.remove();
            }

            // Set new config
            window.LifeLinkConfig = {
                primaryColor: config.primaryColor,
                buttonColor: config.buttonColor,
                position: config.position,
                buttonSize: config.buttonSize,
                windowWidth: config.windowWidth,
                windowHeight: config.windowHeight,
                brandName: config.brandName
            };

            // Reload widget script
            const oldScript = document.querySelector('script[src*="widget.js"]');
            if (oldScript) {
                oldScript.remove();
            }

            const newScript = document.createElement('script');
            newScript.src = 'widget.js?' + Date.now(); // Cache bust
            document.body.appendChild(newScript);
        }

        function copyCode() {
            const code = document.getElementById('embedCode').textContent;
            const decodedCode = code.replace(/&lt;/g, '<').replace(/&gt;/g, '>');
            
            navigator.clipboard.writeText(decodedCode).then(() => {
                const btn = document.querySelector('.copy-btn');
                btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                btn.classList.add('copied');
                
                setTimeout(() => {
                    btn.innerHTML = '<i class="fas fa-copy"></i> Copy Code';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }

        // Initial preview load
        updatePreview();
    </script>
</body>
</html>
